Description: fix privilege escalation via file permission change
Author: Matthieu Herrb <matthieu@herrb.eu>

diff -Nur xorg-server-1.9.0/os/utils.c xorg-server-1.9.0.new/os/utils.c
--- xorg-server-1.9.0/os/utils.c	2011-10-13 12:06:29.864937015 -0400
+++ xorg-server-1.9.0.new/os/utils.c	2011-10-13 12:06:34.120937124 -0400
@@ -309,7 +309,7 @@
     FatalError("Could not create lock file in %s\n", tmp);
   (void) sprintf(pid_str, "%10ld\n", (long)getpid());
   (void) write(lfd, pid_str, 11);
-  (void) chmod(tmp, 0444);
+  (void) fchmod(lfd, 0444);
   (void) close(lfd);
 
   /*
